В задачах компьютерного зрения (CV) используются различные метрики для оценки производительности моделей. Эти метрики зависят от конкретной задачи, будь то классификация, детекция объектов, сегментация изображений или восстановление изображений. Вот пять наиболее распространённых метрик и их применение:

### 1. **Точность (Accuracy)**
**Задачи:** Классификация изображений.

**Описание:** Точность измеряет долю правильных предсказаний относительно общего числа предсказаний. Это простая, но часто используемая метрика для задач классификации, где модель должна присваивать изображению один из нескольких классов.

**Формула:**
\[
\text{Точность} = \frac{\text{Количество правильных предсказаний}}{\text{Общее количество предсказаний}}
\]

**Преимущества и ограничения:**
- **Преимущества:** Легко интерпретировать, подходит для задач с равномерно распределенными классами.
- **Ограничения:** Не учитывает дисбаланс классов. Например, если один класс сильно преобладает, высокая точность может быть достигнута за счёт частых предсказаний этого класса, игнорируя меньшие классы.

### 2. **IoU (Intersection over Union)**
**Задачи:** Сегментация изображений, детекция объектов.

**Описание:** IoU измеряет степень перекрытия между предсказанной областью и истинной областью. Используется для оценки качества предсказанных границ в задачах, где модель должна выделять или ограничивать определённые объекты на изображении.

**Формула:**
\[
\text{IoU} = \frac{\text{Площадь пересечения предсказанной и истинной областей}}{\text{Площадь объединения предсказанной и истинной областей}}
\]

**Преимущества и ограничения:**
- **Преимущества:** Хорошо отражает точность сегментации или детекции, учитывая как истинно-положительные, так и ложно-положительные предсказания.
- **Ограничения:** Жёсткая метрика — даже небольшое несовпадение предсказанной и истинной областей может сильно снизить значение IoU.

### 3. **mAP (Mean Average Precision)**
**Задачи:** Детекция объектов.

**Описание:** mAP используется для оценки качества детекции объектов. Это среднее значение точности (Precision) при различных уровнях полноты (Recall) для всех классов. Метрика учитывает, как хорошо модель детектирует объекты и насколько точно она предсказывает их местоположение.

**Формула:** mAP — это среднее значение по всем классам:

\[
\text{mAP} = \frac{1}{C} \sum_{c=1}^{C} \text{AP}_c
\]

где \(C\) — количество классов, а \(\text{AP}_c\) — средняя точность для класса \(c\).

**Преимущества и ограничения:**
- **Преимущества:** Учитывает как правильность предсказания классов, так и точность локализации объектов, обеспечивая комплексную оценку.
- **Ограничения:** Сложная интерпретация и вычисление по сравнению с простыми метриками, такими как точность.

### 4. **PSNR (Peak Signal-to-Noise Ratio)**
**Задачи:** Восстановление изображений, суперразрешение, денойзинг.

**Описание:** PSNR измеряет качество восстановленного изображения по сравнению с оригиналом. Эта метрика оценивает уровень искажений или шума, внесенных моделью, и используется в задачах, где важно сохранить качество изображения, например, в суперразрешении или устранении шума.

**Формула:**
\[
\text{PSNR} = 10 \cdot \log_{10} \left(\frac{\text{MAX}^2}{\text{MSE}}\right)
\]

где \(\text{MAX}\) — максимальное возможное значение пикселя (например, 255 для 8-битных изображений), а \(\text{MSE}\) — среднеквадратичная ошибка между оригиналом и восстановленным изображением.

**Преимущества и ограничения:**
- **Преимущества:** Высокое значение PSNR указывает на хорошее качество изображения с минимальными искажениями.
- **Ограничения:** PSNR не всегда коррелирует с восприятием качества человеком, поскольку не учитывает структурные различия между изображениями.

### 5. **Dice Coefficient**
**Задачи:** Сегментация изображений.

**Описание:** Коэффициент Dice оценивает сходство между предсказанной и истинной областями сегментации. Это метрика, близкая к IoU, но более чувствительная к малым объектам, поэтому часто используется в медицинской сегментации, где важно точно выделить небольшие структуры.

**Формула:**
\[
\text{Dice Coefficient} = \frac{2 |A \cap B|}{|A| + |B|}
\]

где \(A\) — предсказанная область, \(B\) — истинная область.

**Преимущества и ограничения:**
- **Преимущества:** Особенно эффективен при работе с несбалансированными классами и мелкими объектами, где точность сегментации имеет решающее значение.
- **Ограничения:** Как и IoU, может сильно варьироваться при малых несоответствиях между предсказанием и истиной.

Эти метрики помогают понять, насколько хорошо модель справляется с конкретной задачей компьютерного зрения, будь то классификация, сегментация или восстановление изображений. Выбор метрики зависит от специфики задачи и требований к точности и качеству предсказаний.
